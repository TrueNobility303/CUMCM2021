% 基于已解出的供应量，计算问题2第一部分蒙特卡罗模拟

load datas.mat
load S1.mat

store = 56400;
tot_cost = 0;

global Wdata;
Wdata = [ ...
2228.722909	2091.471194	2086.687549	2090.396821	2094.586691	2099.442788	2103.946976	2107.057604	2108.235009	2107.664493	2106.234781	2105.22956	2105.817512	2108.409079	2111.887995	2113.042447	2107.463828	2092.775876	2071.379274	2062.778145	2152.900943	2269.523075	1369.960226	2160.012439;
5299.899551	5258.797363	5264.352687	5264.312022	5263.755617	5262.802978	5261.746028	5260.872938	5260.345076	5260.17704	5260.257568	5260.409268	5260.463994	5260.317032	5259.949036	5259.435157	5258.817379	5257.679365	5255.429351	5253.281115	5253.793933	5262.869029	5413.542291	5189.019956;
5299.899551	5258.797363	5264.352687	5264.312022	5263.755617	5262.802978	5261.746028	5260.872938	5260.345076	5260.17704	5260.257568	5260.409268	5260.463994	5260.317032	5259.949036	5259.435157	5258.817379	5257.679365	5255.429351	5253.281115	5253.793933	5262.869029	5413.542291	5189.019956;
5299.899551	5258.797363	5264.352687	5264.312022	5263.755617	5262.802978	5261.746028	5260.872938	5260.345076	5260.17704	5260.257568	5260.409268	5260.463994	5260.317032	5259.949036	5259.435157	5258.817379	5257.679365	5255.429351	5253.281115	5253.793933	5262.869029	5413.542291	5189.019956];
% 已求解的各供货商、各周的供应量（作为均值）。
% 其中行1为C供应商，2:4为A供应商

for time = 1:24
    store;
    
    target = 28200;
    store = store - target;
    if store <0
        error("Can't reach target at a time duration")
    end
    
    [a_in,b_in,c_in] = week_supply(time);
    
    store = store + a_in /0.6 + b_in / 0.66 + c_in / 0.72;
    tot_cost = tot_cost + 1.2*a_in+1.1*b_in+1*c_in;
    
    if store < 56400
        error("Can't reach target at a time duration")
    end
end

%disp("Finished")
tot_cost;

function [a_in,b_in,c_in] = week_supply(w)
    global Wdata;
    
    A_mean = Wdata(2:4,w);
    A_std = [100;100;100];
    C_mean = Wdata(1,w);
    C_std = 100;
    b_in = 0;
    a_in = normrnd(A_mean,A_std);
    c_in = normrnd(C_mean,C_std);
    a_in(a_in<0) = 0; a_in(a_in>6000) = 6000;
    c_in(c_in<0) = 0; c_in(c_in>6000) = 6000;
    a_in = sum(a_in);
    c_in = sum(c_in);
end